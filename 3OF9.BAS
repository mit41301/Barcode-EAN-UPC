10  REM TITLE  :  BARCODE PRINTER PROGRAM - CODE 3 OF 9
20  REM TESTED WITH WINDOWS 10 HOME OS
30  REM TESTED WITH QB64 and VERIFIED THE OUTPUT WITH CODE39 SCANNER - OK
40  DIM C$(44), P$(44), G%(1000)
50  FOR I = 0 TO 43
60  READ C$(I), X$
70  C% = VAL("&H" + X$)
80  FOR N% = 9 TO 0 STEP -1
90  P$(I) = RIGHT$(STR$(C% MOD 2), 1) + P$(I)
100 C% = C% \ 2
110 NEXT N%
120 NEXT I
130 CLS
140 DEF SEG = &H40
150 K% = PEEK(&H17)
160 POKE &H17, (K% OR &H40)
170 LOCATE 12, 20: PRINT "Valid Characters are 0-9,A-Z,.,-,+,/,$,% and SPACE"
180 LOCATE 13, 20: PRINT "To Add Check Digit Enter the Data Starting with -$"
190 LOCATE 14, 20: INPUT "Enter the String: "; U$
200 IF LEN(U$) >= 30 THEN PRINT "Enter String with < 30 Characters": END
210 FOR I = 1 TO LEN(U$)
220 FOR J = 0 TO 43
230 IF C$(J) = MID$(U$, I, 1) THEN F$ = F$ + P$(J): S = S + J
240 NEXT J
250 NEXT I
260 Y = (S - 75) MOD 43
270 IF INSTR(U$, "-$") = 1 THEN U$ = U$ + C$(Y): F$ = F$ + P$(Y)
280 SCREEN 2
290 KEY OFF: CLS
300 PRINT C$(43) + U$ + C$(43)
310 GET (0, 0)-(8 * (LEN(U$) + 2), 14), G%
320 CLS
330 PAINT (1, 1)
340 FOR I = 1 TO LEN(F$) + 20
350 FOR J = VAL(MID$(P$(43) + F$ + P$(43), I, 1)) * 2 TO 0 STEP -1
360 LINE (Z, 5)-(Z, 10 + LEN(U$)), I MOD 2 XOR 0
370 Z = Z + 1
380 NEXT J
390 NEXT I
400 PUT ((8 * (LEN(U$) + 2)) / 2, 15 + LEN(U$)), G%
410 POKE &H17, K%
420 DEF SEG
430 WHILE INKEY$ = ""
440 WEND
450 KEY ON: SCREEN 0
460 END
470 DATA 0,34,1,121,2,61,3,160,4,31,5,130,6,70,7,25,8,124,9,64
480 DATA A,109,B,49,C,148,D,19,E,118,F,58,G,D,H,10C,I,4C,J,1C,K,103,L,43
490 DATA M,142,N,13,O,112,P,52,Q,7,R,106,S,46,T,16,U,181,V,C1,W,1C0,X,91
500 DATA Y,190,Z,D0,-,85,.,185," ",C4,$,A8,/,A2,+,8A,%,2A,*,94